<!DOCTYPE html>
<html>
<head>
    <title>üí∞ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#667eea">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
        }
        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        h1 {
            text-align: center;
            color: #fff;
            margin-bottom: 30px;
            font-size: 28px;
        }
        .balance {
            font-size: 48px;
            text-align: center;
            color: #00ff88;
            margin: 20px 0;
            font-weight: bold;
        }
        button {
            background: #4361ee;
            color: white;
            border: none;
            padding: 16px;
            border-radius: 12px;
            width: 100%;
            font-size: 16px;
            margin: 8px 0;
            cursor: pointer;
            transition: 0.3s;
        }
        button:hover {
            background: #3a56d4;
            transform: translateY(-2px);
        }
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        .stat-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        .loader {
            display: none;
            text-align: center;
            padding: 20px;
        }
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #00ff88;
            color: #000;
            padding: 10px 20px;
            border-radius: 10px;
            display: none;
            z-index: 1000;
        }
        .error-card {
            text-align: center;
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.3);
        }
        .error-card ol {
            text-align: left;
            padding-left: 20px;
        }
        .payment-info {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid #00ff88;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 14px;
        }
        .payment-info code {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            word-break: break-all;
            display: block;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>
    <div class="container">
        <div class="loader" id="loader">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
        
        <div id="app-content">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </div>

    <script>
        // Telegram Web App API
        let tg = window.Telegram.WebApp;
        let user = tg.initDataUnsafe.user;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
        document.getElementById('loader').style.display = 'block';
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–ª—É—á–µ–Ω—ã
        if (!user || !user.id) {
            console.error("‚ùå User data not received from Telegram!");
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
            document.getElementById('loader').style.display = 'none';
            document.getElementById('app-content').innerHTML = `
                <div class="card error-card">
                    <h2>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h2>
                    <p><b>Telegram –Ω–µ –ø–µ—Ä–µ–¥–∞–ª –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</b></p>
                    <p><b>–†–µ—à–µ–Ω–∏–µ:</b></p>
                    <ol>
                        <li>–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –º–µ–Ω—é –±–æ—Ç–∞</li>
                        <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é Telegram</li>
                        <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤ Telegram Desktop</li>
                        <li>–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</li>
                    </ol>
                    <button onclick="location.reload()">üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
                    <button onclick="testWithData()">üß™ –¢–µ—Å—Ç —Å –¥–∞–Ω–Ω—ã–º–∏</button>
                </div>
            `;
            document.getElementById('app-content').style.display = 'block';
        } else {
            // –î–∞–Ω–Ω—ã–µ –µ—Å—Ç—å - –∑–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            loadUserData();
        }
        
        // –¢–µ—Å—Ç —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        function testWithData() {
            user = {
                id: 123456789,
                first_name: "–¢–µ—Å—Ç–æ–≤—ã–π",
                username: "test_user"
            };
            loadUserData();
            showNotification("‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ");
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(text, isError = false) {
            const notification = document.getElementById('notification');
            notification.textContent = text;
            notification.style.background = isError ? '#ff4444' : '#00ff88';
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–∞–Ω–Ω—ã–º–∏
        function updateUI(userData) {
            if (userData) {
                const appContent = `
                    <h1 id="welcome-text">üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${userData.first_name}!</h1>
                    
                    <div class="card">
                        <h2>–í–∞—à –±–∞–ª–∞–Ω—Å</h2>
                        <div class="balance" id="balance">$${userData.balance.toFixed(2)}</div>
                        <div style="text-align: center; margin-bottom: 15px;">
                            <small>ID: <span id="user-id">${userData.id}</span></small>
                        </div>
                        <button onclick="showDepositPopup()">üí≥ –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å</button>
                        <button onclick="showWithdrawPopup()">üì§ –í—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞</button>
                    </div>
                    
                    <div class="card">
                        <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                        <div class="stats">
                            <div class="stat-item">
                                <div>üìà –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</div>
                                <div style="color: #00ff88; font-weight: bold;" id="profit-rate">${userData.profit_rate}%/–¥–µ–Ω—å</div>
                            </div>
                            <div class="stat-item">
                                <div>üë• –†–µ—Ñ–µ—Ä–∞–ª—ã</div>
                                <div style="font-weight: bold;" id="referrals-count">${userData.referrals ? userData.referrals.length : 0}</div>
                            </div>
                            <div class="stat-item">
                                <div>üí∞ –ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ</div>
                                <div style="font-weight: bold;" id="invested">$${userData.invested.toFixed(2)}</div>
                            </div>
                            <div class="stat-item">
                                <div>üèÜ –£—Ä–æ–≤–µ–Ω—å</div>
                                <div style="color: #FFD700; font-weight: bold;" id="user-level">${getLevelName(userData.level)}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <button onclick="showRefs()">üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</button>
                        <button onclick="showCareer()">üèÜ –ö–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç</button>
                        <button onclick="showCalculator()">üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏</button>
                        <button onclick="showHistory()">üìã –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</button>
                        <button onclick="refreshData()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                    </div>
                `;
                
                document.getElementById('app-content').innerHTML = appContent;
            }
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è
        function getLevelName(level) {
            const levels = {
                'bronze': 'ü•â –õ–∞—Ç—É–Ω—å',
                'silver': 'ü•à –°–µ—Ä–µ–±—Ä–æ',
                'gold': 'ü•á –ó–æ–ª–æ—Ç–æ',
                'platinum': 'üíé –ü–ª–∞—Ç–∏–Ω–∞'
            };
            return levels[level] || '–õ–∞—Ç—É–Ω—å';
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserData() {
            if (user && user.id) {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                tg.sendData(JSON.stringify({
                    action: 'get_user',
                    user_id: user.id,
                    username: user.username,
                    first_name: user.first_name,
                    timestamp: new Date().toISOString()
                }));
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                const testData = {
                    id: user.id,
                    first_name: user.first_name || "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
                    balance: 1250.50,
                    profit_rate: 1.5,
                    invested: 500,
                    referrals: [],
                    level: 'bronze'
                };
                
                updateUI(testData);
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('app-content').style.display = 'block';
                showNotification("‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!");
            }, 1000);
        }
        
        // ================== –ü–û–ü–û–õ–ù–ï–ù–ò–ï –ë–ê–õ–ê–ù–°–ê ==================
        function showDepositPopup() {
            tg.showPopup({
                title: 'üí≥ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞',
                message: '–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:',
                buttons: [
                    {id: 'card', text: 'üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞', type: 'default'},
                    {id: 'crypto', text: '‚Çø –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞ (USDT)', type: 'default'},
                    {id: 'cancel', text: '‚ùå –û—Ç–º–µ–Ω–∞', type: 'cancel'}
                ]
            }).then(function(btnId) {
                if (btnId === 'card') {
                    showCardDeposit();
                } else if (btnId === 'crypto') {
                    showCryptoDeposit();
                }
            });
        }
        
        function showCardDeposit() {
            tg.showPopup({
                title: 'üí≥ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ–π',
                message: '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è ($50 - $5000):',
                buttons: [
                    {id: '50', text: '$50', type: 'default'},
                    {id: '100', text: '$100', type: 'default'},
                    {id: '500', text: '$500', type: 'default'},
                    {id: 'custom', text: 'üí∞ –î—Ä—É–≥–∞—è —Å—É–º–º–∞', type: 'default'},
                    {id: 'back', text: '‚Ü©Ô∏è –ù–∞–∑–∞–¥', type: 'cancel'}
                ]
            }).then(function(btnId) {
                if (btnId && btnId !== 'back') {
                    if (btnId === 'custom') {
                        tg.showPopup({
                            title: '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É',
                            message: '–ú–∏–Ω–∏–º—É–º: $50\n–ú–∞–∫—Å–∏–º—É–º: $5000',
                            buttons: [
                                {id: 'confirm', text: '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å', type: 'default'},
                                {id: 'back', text: '–ù–∞–∑–∞–¥', type: 'cancel'}
                            ]
                        }).then(function(btnId2) {
                            if (btnId2 === 'confirm') {
                                processDeposit(100, 'card'); // –¢–µ—Å—Ç–æ–≤–∞—è —Å—É–º–º–∞ $100
                            }
                        });
                    } else {
                        const amount = parseInt(btnId);
                        processDeposit(amount, 'card');
                    }
                }
            });
        }
        
        function showCryptoDeposit() {
            const cryptoAddress = 'TQNmjGXUbNMuN8sG1AkECjLZKdPq6SpYxN'; // –¢–µ—Å—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å TRC20
            const amounts = [50, 100, 200, 500, 1000];
            
            let buttons = amounts.map(amount => ({
                id: `crypto_${amount}`,
                text: `$${amount} (USDT)`,
                type: 'default'
            }));
            
            buttons.push({id: 'back', text: '‚Ü©Ô∏è –ù–∞–∑–∞–¥', type: 'cancel'});
            
            const message = `üìã <b>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–ø–ª–∞—Ç–µ:</b>\n\n` +
                           `1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ USDT –Ω–∞ –∞–¥—Ä–µ—Å:\n` +
                           `<code>${cryptoAddress}</code>\n\n` +
                           `2. –°–µ—Ç—å: <b>TRC20 (Tron)</b>\n` +
                           `3. –ú–∏–Ω–∏–º—É–º: <b>$50 USDT</b>\n\n` +
                           `‚úÖ –ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–∏—Ç—Å—è –ø–æ—Å–ª–µ 1 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–µ—Ç–∏\n` +
                           `‚è±Ô∏è –û–±—ã—á–Ω–æ —ç—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç 2-5 –º–∏–Ω—É—Ç`;
            
            tg.showPopup({
                title: '‚Çø –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ USDT (TRC20)',
                message: message,
                buttons: buttons
            }).then(function(btnId) {
                if (btnId && btnId !== 'back' && btnId.startsWith('crypto_')) {
                    const amount = parseInt(btnId.split('_')[1]);
                    
                    tg.showAlert(
                        '‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –æ–ø–ª–∞—Ç–µ!\n\n' +
                        `–°—É–º–º–∞: <b>$${amount} USDT</b>\n` +
                        `–ê–¥—Ä–µ—Å: <code>${cryptoAddress}</code>\n` +
                        `–°–µ—Ç—å: <b>TRC20</b>\n\n` +
                        '–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É"'
                    ).then(() => {
                        tg.showPopup({
                            title: '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã',
                            message: `–í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ $${amount} USDT?`,
                            buttons: [
                                {id: 'confirm_paid', text: '‚úÖ –î–∞, –æ—Ç–ø—Ä–∞–≤–∏–ª', type: 'default'},
                                {id: 'cancel', text: '‚ùå –ù–µ—Ç, –æ—Ç–º–µ–Ω–∞', type: 'cancel'}
                            ]
                        }).then(function(confirmBtn) {
                            if (confirmBtn === 'confirm_paid') {
                                // –≠–º—É–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
                                showNotification(`‚è≥ –û–∂–∏–¥–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–µ—Ç–∏...`);
                                
                                setTimeout(() => {
                                    processDeposit(amount, 'crypto');
                                    showNotification(`‚úÖ –û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞! +$${amount}`);
                                }, 3000);
                            }
                        });
                    });
                }
            });
        }
        
        function processDeposit(amount, method) {
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
            tg.sendData(JSON.stringify({
                action: 'deposit',
                user_id: user.id,
                data: { 
                    amount: amount,
                    method: method,
                    status: 'completed',
                    timestamp: new Date().toISOString()
                }
            }));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –ª–æ–∫–∞–ª—å–Ω–æ
            const balanceElem = document.getElementById('balance');
            const currentBalance = parseFloat(balanceElem.textContent.replace('$', ''));
            balanceElem.textContent = `$${(currentBalance + amount).toFixed(2)}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—É–º–º—É
            const investedElem = document.getElementById('invested');
            const currentInvested = parseFloat(investedElem.textContent.replace('$', ''));
            investedElem.textContent = `$${(currentInvested + amount).toFixed(2)}`;
        }
        
        // ================== –í–´–í–û–î –°–†–ï–î–°–¢–í ==================
        function showWithdrawPopup() {
            const currentBalance = parseFloat(document.getElementById('balance').textContent.replace('$', ''));
            
            if (currentBalance < 50) {
                tg.showAlert('‚ùå –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞: $50\n\n–î–æ—Å—Ç—É–ø–Ω–æ: $' + currentBalance.toFixed(2));
                return;
            }
            
            tg.showPopup({
                title: 'üì§ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤',
                message: `üí∞ –î–æ—Å—Ç—É–ø–Ω–æ: $${currentBalance.toFixed(2)}\n\n–í—ã–±–µ—Ä–∏—Ç–µ —Å—É–º–º—É –≤—ã–≤–æ–¥–∞:`,
                buttons: [
                    {id: '50', text: '$50', type: 'default'},
                    {id: '100', text: '$100', type: 'default'},
                    {id: '200', text: '$200', type: 'default'},
                    {id: 'custom', text: 'üí∞ –î—Ä—É–≥–∞—è —Å—É–º–º–∞', type: 'default'},
                    {id: 'cancel', text: '‚ùå –û—Ç–º–µ–Ω–∞', type: 'cancel'}
                ]
            }).then(function(btnId) {
                if (btnId === 'cancel') return;
                
                let amount = 0;
                if (btnId === 'custom') {
                    tg.showPopup({
                        title: '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É',
                        message: `–ú–∞–∫—Å–∏–º—É–º: $${currentBalance.toFixed(2)}`,
                        buttons: [
                            {id: 'confirm_custom', text: '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å', type: 'default'},
                            {id: 'back', text: '–ù–∞–∑–∞–¥', type: 'cancel'}
                        ]
                    });
                    return;
                } else {
                    amount = parseInt(btnId);
                }
                
                if (amount > 0 && amount <= currentBalance) {
                    showWithdrawMethod(amount);
                } else {
                    tg.showAlert('‚ùå –ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞!');
                }
            });
        }
        
        function showWithdrawMethod(amount) {
            tg.showPopup({
                title: 'üì§ –°–ø–æ—Å–æ–± –≤—ã–≤–æ–¥–∞',
                message: `–°—É–º–º–∞: $${amount.toFixed(2)}\n\n–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è:`,
                buttons: [
                    {id: 'card', text: 'üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞', type: 'default'},
                    {id: 'crypto', text: '‚Çø –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞', type: 'default'},
                    {id: 'back', text: '‚Ü©Ô∏è –ù–∞–∑–∞–¥', type: 'cancel'}
                ]
            }).then(function(method) {
                if (method === 'card') {
                    processWithdrawal(amount, 'card');
                } else if (method === 'crypto') {
                    processWithdrawal(amount, 'crypto');
                }
            });
        }
        
        function processWithdrawal(amount, method) {
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥
            tg.sendData(JSON.stringify({
                action: 'withdraw',
                user_id: user.id,
                data: { 
                    amount: amount,
                    method: method,
                    status: 'pending',
                    timestamp: new Date().toISOString()
                }
            }));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –ª–æ–∫–∞–ª—å–Ω–æ
            const balanceElem = document.getElementById('balance');
            const currentBalance = parseFloat(balanceElem.textContent.replace('$', ''));
            balanceElem.textContent = `$${(currentBalance - amount).toFixed(2)}`;
            
            showNotification(`‚úÖ –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ $${amount} —Å–æ–∑–¥–∞–Ω–∞!`);
            
            tg.showAlert(
                'üìã –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∞!\n\n' +
                `üí∞ –°—É–º–º–∞: $${amount.toFixed(2)}\n` +
                `üìù –°–ø–æ—Å–æ–±: ${method === 'card' ? '–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞' : '–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞'}\n` +
                `‚è±Ô∏è –°—Ç–∞—Ç—É—Å: –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏\n\n` +
                `‚úÖ –û–±—ã—á–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 1-24 —á–∞—Å–∞.\n` +
                `üì± –°—Ç–∞—Ç—É—Å –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π.`
            );
        }
        
        // –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê
        function showRefs() {
            if (user) {
                let refLink = `https://t.me/${tg.initDataUnsafe.user?.username || 'your_bot'}?start=ref${user.id}`;
                const refCount = parseInt(document.getElementById('referrals-count').textContent);
                const earned = refCount * 50;
                
                tg.showAlert(
                    'üë• –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê\n\n' +
                    `üîó <b>–í–∞—à–∞ —Å—Å—ã–ª–∫–∞:</b>\n<code>${refLink}</code>\n\n` +
                    `üìä <b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</b>\n` +
                    `‚Ä¢ –†–µ—Ñ–µ—Ä–∞–ª–æ–≤: ${refCount}\n` +
                    `‚Ä¢ –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: $${earned.toFixed(2)}\n\n` +
                    'üíé <b>–£—Å–ª–æ–≤–∏—è:</b>\n' +
                    '‚Ä¢ 10% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–∞\n' +
                    '‚Ä¢ 5% –æ—Ç –µ–≥–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏\n' +
                    '‚Ä¢ 3 —É—Ä–æ–≤–Ω—è —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤\n\n' +
                    'üèÜ <b>–ë–æ–Ω—É—Å:</b>\n' +
                    '–ó–∞ –∫–∞–∂–¥—ã—Ö 5 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ +0.1% –∫ –≤–∞—à–µ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏!'
                );
            }
        }
        
        // –ö–ê–†–¨–ï–†–ù–´–ô –†–û–°–¢
        function showCareer() {
            tg.showAlert(
                'üèÜ –ö–ê–†–¨–ï–†–ù–´–ô –†–û–°–¢\n\n' +
                'ü•â <b>–õ–∞—Ç—É–Ω—å (–±–∞–∑–æ–≤—ã–π):</b>\n' +
                '‚Ä¢ –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 1.5%/–¥–µ–Ω—å\n' +
                '‚Ä¢ –ú–∏–Ω. –¥–µ–ø–æ–∑–∏—Ç: $50\n' +
                '‚Ä¢ –†–µ—Ñ–µ—Ä–∞–ª–æ–≤: 0+\n\n' +
                'ü•à <b>–°–µ—Ä–µ–±—Ä–æ (5 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤):</b>\n' +
                '‚Ä¢ –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 2.0%/–¥–µ–Ω—å\n' +
                '‚Ä¢ –ú–∏–Ω. –¥–µ–ø–æ–∑–∏—Ç: $200\n' +
                '‚Ä¢ –ë–æ–Ω—É—Å: +5% –∫ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º\n\n' +
                'ü•á <b>–ó–æ–ª–æ—Ç–æ (20 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤):</b>\n' +
                '‚Ä¢ –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 2.5%/–¥–µ–Ω—å\n' +
                '‚Ä¢ –ú–∏–Ω. –¥–µ–ø–æ–∑–∏—Ç: $1000\n' +
                '‚Ä¢ –ë–æ–Ω—É—Å: +10% –∫ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º\n\n' +
                'üíé <b>–ü–ª–∞—Ç–∏–Ω–∞ (50 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤):</b>\n' +
                '‚Ä¢ –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 3.0%/–¥–µ–Ω—å\n' +
                '‚Ä¢ –ú–∏–Ω. –¥–µ–ø–æ–∑–∏—Ç: $5000\n' +
                '‚Ä¢ –ë–æ–Ω—É—Å: +15% –∫ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º'
            );
        }
        
        // –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –î–û–•–û–î–ù–û–°–¢–ò
        function showCalculator() {
            const invested = parseFloat(document.getElementById('invested').textContent.replace('$', '')) || 1000;
            const rate = parseFloat(document.getElementById('profit-rate').textContent) || 1.5;
            
            const daily = invested * (rate / 100);
            const monthly = daily * 30;
            const yearly = daily * 365;
            
            tg.showAlert(
                'üßÆ –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –î–û–•–û–î–ù–û–°–¢–ò\n\n' +
                `–ü—Ä–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏: <b>$${invested.toFixed(2)}</b>\n` +
                `–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: <b>${rate}%/–¥–µ–Ω—å</b>\n\n` +
                'üìà <b>–ü—Ä–∏–±—ã–ª—å:</b>\n' +
                `‚Ä¢ –ó–∞ –¥–µ–Ω—å: <b>$${daily.toFixed(2)}</b>\n` +
                `‚Ä¢ –ó–∞ –º–µ—Å—è—Ü: <b>$${monthly.toFixed(2)}</b>\n` +
                `‚Ä¢ –ó–∞ –≥–æ–¥: <b>$${yearly.toFixed(2)}</b>\n\n` +
                'üíµ <b>–ò—Ç–æ–≥–æ–≤—ã–µ —Å—É–º–º—ã:</b>\n' +
                `‚Ä¢ –ß–µ—Ä–µ–∑ –º–µ—Å—è—Ü: <b>$${(invested + monthly).toFixed(2)}</b>\n` +
                `‚Ä¢ –ß–µ—Ä–µ–∑ –≥–æ–¥: <b>$${(invested + yearly).toFixed(2)}</b>`
            );
        }
        
        // –ò–°–¢–û–†–ò–Ø –û–ü–ï–†–ê–¶–ò–ô
        function showHistory() {
            tg.showAlert(
                'üìã –ò–°–¢–û–†–ò–Ø –û–ü–ï–†–ê–¶–ò–ô\n\n' +
                '–ü–æ–∫–∞ —á—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–µ—Ç.\n\n' +
                '–ü–æ—Å–ª–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∏–ª–∏ –≤—ã–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –¥–∞—Ç–∞–º–∏, —Å—É–º–º–∞–º–∏ –∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏.\n\n' +
                '‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ\n' +
                '‚è≥ –í –æ–±—Ä–∞–±–æ—Ç–∫–µ\n' +
                '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ'
            );
        }
        
        // –û–ë–ù–û–í–ò–¢–¨ –î–ê–ù–ù–´–ï
        function refreshData() {
            document.getElementById('loader').style.display = 'block';
            document.getElementById('app-content').style.display = 'none';
            
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('app-content').style.display = 'block';
                showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!');
            }, 1000);
        }
        
        // –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –≤ Telegram
        tg.BackButton.show();
        tg.BackButton.onClick(function() {
            tg.close();
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Web App
        tg.ready();
        tg.expand();
        tg.setHeaderColor('#667eea');
        tg.setBackgroundColor('#667eea');
    </script>
</body>
</html>
